!function(t){t.fn.metalClone=function(e,n){function o(e,n,o,a){var l=n;if(e=0==e?1:e,"after"===a)for(var s=0;e>s;s++){var p=l.clone();o.append(p.append('<input type="button" value="'+d+'" class="metalBtnRemove">')),u||i(p)}else if("before"===a)for(var s=0;e>s;s++){var p=l.clone();o.prepend(p.append('<input type="button" value="'+d+'" class="metalBtnRemove">')),u||i(p)}t.isArray(m)&&t.isEmptyObject(m)||t.isArray(m)&&!t.isEmptyObject(m)&&r(m)}function a(e,n,o,a){var l=n;if(e=0==e?1:e,"after"===a)for(var s=0;e>s;s++){var p=l.clone();p.insertAfter(o).append('<input type="button" value="'+d+'" class="metalBtnRemove">'),u||i(p)}else if("before"===a)for(var s=0;e>s;s++){var p=l.clone();p.insertBefore(o).append('<input type="button" value="'+d+'" class="metalBtnRemove">'),u||i(p)}t.isArray(m)&&t.isEmptyObject(m)||t.isArray(m)&&!t.isEmptyObject(m)&&r(m)}function i(e){e.find('input:not("input[type=button], input[type=submit]"), textarea, select').each(function(){t(this).val("")})}function r(e){var n;n=t.inArray("*",e)?"*":e.join(","),t(s).each(function(e,o){t(this).find(n).each(function(n,o){if(t(this).attr("id")){var a=t(this).attr("id"),i=a.replace(/\d+/g,"");t(this).attr("id",i+parseInt(e))}})})}opt=t.extend({},t.fn.metalClone.defaults,e);var l,s=this.selector;l=s.match(/[.]/)?t(this).first():t(this);var p;null===opt.btnClone?(p="metalBtnClone"+Math.floor(9*Math.random()+1),t("<input/>",{type:"button",value:opt.btnCloneText,"class":p}).insertAfter(s),p="."+p):p=opt.btnClone;var u=opt.copyValue,c=opt.position,f=opt.numberToClone,v=opt.destination,m=opt.ids,d=opt.btnRemoveText;return t(document).on("click",p,function(){var e;return v!==!1?(e=t(v),"after"===c?void o(f,l,e,c):void o(f,l,e,c)):(e=t(s),"after"===c?void a(f,l,e.last(),c):void a(f,l,e.first(),c))}),t(document).on("click",".metalBtnRemove",function(){t(this).closest(s).remove()}),l.each(function(e,n){t(this)})},t.fn.metalClone.defaults={destination:!1,position:"after",numberToClone:1,ids:[],btnClone:null,copyValue:!1,btnRemoveText:"Remove me",btnCloneText:"Create New Element"}}(jQuery);